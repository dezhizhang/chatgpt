"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9213],{9213:function(e,s,t){t.r(s),t.d(s,{ForgetPasswordForm:function(){return f}});var a=t(57437),r=t(2265),n=t(13621),i=t(51371),l=t(21463),o=t(59100),c=t(26621),d=t(71504),u=t(15894),m=t(45138),p=t(24351),x=t(29380),h=t(61865);let g={maxWidth:"100%",borderRadius:"4px",textAlign:"left"};function f(e){let{setPageType:s}=e,{register:t,handleSubmit:f,getValues:w,trigger:j,formState:{errors:y}}=(0,h.cI)({mode:"onBlur"}),{toast:v}=(0,p.p)(),[b,I]=(0,r.useState)(!1),{codeSending:z,sendCodeText:S,sendCode:k,codeCountDown:A}=(0,u.A)(),C=(0,r.useCallback)(async e=>{let{username:t,code:a,password:r}=e;I(!0);let n=await (0,m.Q0)({username:t,code:a,password:r}),{user:i}=n||{};if(I(!1),null==i?void 0:i._id){v({title:"密码已找回",status:"success"}),s(x.DZ.login);return}v({title:n.message||"修改密码异常",status:"error"})},[v]),_=(0,r.useCallback)(async()=>{let e=await j("username");e&&k({username:w("username"),type:"findPassword"})},[w,k,j]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.xu,{fontWeight:"bold",fontSize:"2xl",textAlign:"center",children:"找回千知GPT账号"}),(0,a.jsxs)("form",{onSubmit:f(C),children:[(0,a.jsxs)(i.NI,{mt:5,isInvalid:!!y.username,children:[(0,a.jsx)(l.I,{placeholder:"邮箱/手机号",style:g,...t("username",{required:"邮箱/手机号不能为空",pattern:{value:/(^1[3456789]\d{9}$)|(^[A-Za-z0-9]+([_\.][A-Za-z0-9]+)*@([A-Za-z0-9\-]+\.)+[A-Za-z]{2,6}$)/,message:"邮箱/手机号格式错误"}})}),(0,a.jsx)(o.J1,{position:"absolute",fontSize:"xs",children:!!y.username&&y.username.message})]}),(0,a.jsxs)(i.NI,{mt:8,isInvalid:!!y.username,children:[(0,a.jsxs)(c.k,{children:[(0,a.jsx)(l.I,{flex:1,style:g,placeholder:"验证码",...t("code",{required:"验证码不能为空"})}),(0,a.jsx)(d.z,{ml:5,w:"145px",maxW:"50%",onClick:_,isDisabled:A>0,isLoading:z,children:S})]}),(0,a.jsx)(o.J1,{position:"absolute",fontSize:"xs",children:!!y.code&&y.code.message})]}),(0,a.jsxs)(i.NI,{mt:8,isInvalid:!!y.password,children:[(0,a.jsx)(l.I,{type:"password",placeholder:"新密码",style:g,...t("password",{required:"密码不能为空",minLength:{value:4,message:"密码最少4位最多12位"},maxLength:{value:12,message:"密码最少4位最多12位"}})}),(0,a.jsx)(o.J1,{position:"absolute",fontSize:"xs",children:!!y.password&&y.password.message})]}),(0,a.jsxs)(i.NI,{mt:8,isInvalid:!!y.password2,children:[(0,a.jsx)(l.I,{type:"password",placeholder:"确认密码",style:g,...t("password2",{validate:e=>w("password")===e||"两次密码不一致"})}),(0,a.jsx)(o.J1,{position:"absolute",fontSize:"xs",children:!!y.password2&&y.password2.message})]}),(0,a.jsx)(n.xu,{float:"right",fontSize:"sm",mt:2,color:"myBlue.600",cursor:"pointer",_hover:{textDecoration:"underline"},onClick:()=>s(x.DZ.login),children:"去登录"}),(0,a.jsx)(d.z,{type:"submit",mt:5,w:"100%",size:["md","lg"],colorScheme:"blue",isLoading:b,children:"找回密码"})]})]})}},15894:function(e,s,t){let a;t.d(s,{A:function(){return o}});var r=t(2265),n=t(45138),i=t(24351);t(24101);let l=e=>{var s;return"undefined"!=typeof grecaptcha&&(null===(s=grecaptcha)||void 0===s?void 0:s.ready)?new Promise((s,t)=>{grecaptcha.ready(async()=>{try{let t=await grecaptcha.execute(e,{action:"submit"});s(t)}catch(e){t(e)}})}):""},o=()=>{let{toast:e}=(0,i.p)(),[s,t]=(0,r.useState)(!1),[o,c]=(0,r.useState)(0),d=(0,r.useMemo)(()=>o>=10?"".concat(o,"s后重新获取"):o>0?"0".concat(o,"s后重新获取"):"获取验证码",[o]),u=(0,r.useCallback)(async s=>{let{username:r,type:i}=s;t(!0);try{await (0,n.oK)({username:r,type:i,googleToken:await l("123")}),c(60),a=setInterval(()=>{c(e=>(e<=0&&clearInterval(a),e-1))},1e3),e({title:"验证码已发送",status:"success",position:"top"})}catch(s){e({title:s.message||"发送验证码异常",status:"error"})}t(!1)},[e]);return{codeSending:s,sendCode:u,sendCodeText:d,codeCountDown:o}}}}]);